<!DOCTYPE html>
<html>
  	<head>
    	<title>Evaluate matching</title>
    	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<!-- Bootstrap -->
    	<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    	<!-- Main css -->
    	<link href="css/main.css" rel="stylesheet" media="screen">
  	</head>
  	<body>
  		<div class="container">
	    	<form id="evaluationform" class="form-horizontal" method="post" enctype="multipart/form-data">
				<div class="form-group">
					<label class="col-xs-2" for="resultupload">Result from matching (xml)</label>
					<div class="col-xs-3">
		    			<input type="text" id="resultupload" class="uploadFile form-control" placeholder="Choose File" disabled="disabled"/>
		    		</div>
				  	<div class="fileUpload btn btn-default">			  		
					    <span>Upload</span>
					    <input id="resultbtn" type="file" class="upload" name="resultfile"/>
					</div>
				</div>
				<div class="form-group">
					<label class="col-xs-2" for="groundtruthupload">Ground truth (xml)</label>
					<div class="col-xs-3">
		    			<input type="text" id="groundtruthupload" class="uploadFile form-control" placeholder="Choose File" disabled="disabled"/>
		    		</div>
				  	<div class="fileUpload btn btn-default">			  		
					    <span>Upload</span>
					    <input id="groundtruthbtn" type="file" class="upload" name="groundtruthfile" />
					</div>
				</div>
				<div class="col-xs-offset-2">
					<button id="evalButton" type="submit" class="btn btn-primary">Evaluate</button>
				</div>
			</form>
		</div>
		<script src="http://code.jquery.com/jquery.js"></script>
    	<script src="js/bootstrap.min.js"></script>
    	<!-- Fill in the filenames of the chosen files -->
		<script>

			// Stay on the same page when updating and instead send an Ajax POST with the form contents
			$('#syncform').submit(function(e) {
				e.preventDefault();
				// Make sure the buttons are still hidden
				$("#downloadbutton").hide();
				$("#cancelbutton").hide();
				// Make sure the progressbar is reset
				$("#syncprogressbar").text("0%");
				$("#syncprogressbar").width("0%");
				// Show the dialog
				$('#progressModal').modal('show');
				var form = $('#syncform');
				var formData = new FormData(form[0]);
			    $.ajax( {
					type: "POST",
					url: "/synchronize",
					data: formData,
					success: function( response ) {
						pid = response;
						$("#cancelbutton").show();
						// Update the progress each second starting when the upload is finished
						intervalid = setInterval(function(){checkProgress()},1000);
					},
					// Ignore the content of the POST
			        contentType: false,
			        processData: false,
			    });
			});
			document.getElementById("subtitlebtn").onchange = function () {
				// Remove the fakepath prefix if there is one
    			document.getElementById("subtitleupload").value = this.value.replace("C:\\fakepath\\", "");;
			};
			document.getElementById("bookbtn").onchange = function () {
				// Remove the fakepath prefix if there is one
    			document.getElementById("bookupload").value = this.value.replace("C:\\fakepath\\", "");;
			};
		</script>

  	</body>
</html>
